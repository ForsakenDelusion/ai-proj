## 网格空间编码器

对经度进行以下操作，获得编码向量

$$
\begin{aligned}
PE(l_{lat}, 2k) &= \sin(\frac{l_{lat}}{10000^{2k/D}}) \\
PE(l_{lat}, 2k + 1) &= \cos(\frac{l_{lat}}{10000^{2k/D}})
\end{aligned}
\quad k = 0, 1, ..., \frac{D}{2} - 1

$$

同理，对纬度也进行如下操作

$$
\begin{aligned}
PE(l_{lon}, 2k) &= \sin(\frac{l_{lat}}{10000^{2k/D}}) \\
PE(l_{lon}, 2k + 1) &= \cos(\frac{l_{lat}}{10000^{2k/D}})
\end{aligned}
\quad k = 0, 1, ..., \frac{D}{2} - 1

$$

> Q1:为什么要进行编码操作

> A1:为了解决非线性，非周期，破坏语义信息三个问题

    - 非线性：经纬度和地理位置的对应关系并非线性表示
    - 非周期：空间邻近性的断裂，比如179.9和0
    - 破坏语义信息：都是首都，但是经纬度并不能体现这一点

> Q2:为什么要对奇偶不同的k进行正余弦变换

> A2:因为$PE_k(x) = \sin(\omega_k x)$是有歧义的，因为$\sin(x) = \sin(\pi - x)$所以不同位置可能编码一样，但是分为$(\sin(\omega x), \cos(\omega x))$，则可以表示单位圆上的一个点

>Q3:这个k是什么？
>A3:表示频率的敏感度，高频的话就对一些细微的差距很敏感，可以用于识别小范围的变化（比如下个十字路口和这个十字路口的区别）。低频则是对更宏观的变化的识别（比如跨城市）
